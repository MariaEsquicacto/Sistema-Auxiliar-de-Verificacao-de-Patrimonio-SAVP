<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/relatorio.css">
    <link rel="stylesheet" href="../css/relatorio_excel.css">
    <link rel="stylesheet" href="../css/relatorio_dashboard.css">
    <title>Relatório</title>
</head>
<body>
    <header>
        <div class="header-colaborador">
        <div class="menu">
            <button class="hamburguer">
                <i class="bi bi-list"></i>
            </button>
        </div>
        <div class="logo">
            <img src="../assets/logo_senai.png" alt="logo-senai">
        </div>
        <div class="notificacao">
            <i class="bi bi-bell"></i>
        </div>
    </div>
    </header>
   
    <main class="conteudo-relatorio">

        <div class="titulo-relatorio">
            <a href="relatorio.html" class="voltar"><i class="fa-solid fa-arrow-left"></i></a>
            <h1>Dashboard</h1>
        </div>

        <div class="cards-resumo">
            <div class="card-patrimonio">
                <p>Patrimônio Total</p>
                <span>256</span>
            </div>
            <div class="grafico-legenda">
                <div class="legenda">
                    <div class="item-legenda">
                        <span class="cor-legenda verde"></span>
                        <p>Local correto</p>
                    </div>
                    <div class="item-legenda">
                        <span class="cor-legenda amarelo"></span>
                        <p>Em alerta</p>
                    </div>
                    <div class="item-legenda">
                        <span class="cor-legenda vermelho"></span>
                        <p>Não encontrado</p>
                    </div>
                </div>
                <div class="grafico-pizza">
                    <div class="fatia fatia-verde"></div>
                    <div class="fatia fatia-amarela"></div>
                    <div class="fatia fatia-vermelha"></div>
                </div>
            </div>
        </div>

        <div class="tabela-container">
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>SETOR</th>
                        <th>NOME</th>
                        <th>DESCRIÇÃO</th>
                        <th>CÓDIGO</th>
                        <th>STATUS</th>
                        <th>ANEXO</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>1</td>
                        <td>Computador</td>
                        <td>Computador Dell</td>
                        <td>1015978</td>
                        <td class="status-verde"><i class="fas fa-check-circle"></i></td>
                        <td><i class="fas fa-link"></i></td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>1</td>
                        <td>Impressora</td>
                        <td>Impressora Dell</td>
                        <td>1015978</td>
                        <td class="status-amarelo"><i class="fas fa-exclamation-triangle"></i></td>
                        <td><i class="fas fa-link"></i></td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>2</td>
                        <td>Mesa</td>
                        <td>Mesa do professor</td>
                        <td>1015978</td>
                        <td class="status-vermelho"><i class="fas fa-times-circle"></i></td>
                        <td><i class="fas fa-link"></i></td>
                    </tr>
                     <tr>
                        <td>4</td>
                        <td>3</td>
                        <td>Cadeira</td>
                        <td>Cadeira 01</td>
                        <td>1015978</td>
                        <td class="status-verde"><i class="fas fa-check-circle"></i></td>
                        <td><i class="fas fa-link"></i></td>
                    </tr>
                     <tr>
                        <td>5</td>
                        <td>10</td>
                        <td>Computador</td>
                        <td>Computador Dell</td>
                        <td>1015978</td>
                        <td class="status-verde"><i class="fas fa-check-circle"></i></td>
                        <td><i class="fas fa-link"></i></td>
                    </tr>
                    </tbody>
            </table>
        </div>
        <button class="btn-salvar">Salvar</button>
    </main>

    <script>
        document.querySelector('.btn-baixar').addEventListener('click', function() {
            let table = document.querySelector('table');
            let rows = table.querySelectorAll('tr');
            let csvContent = '';
        
            rows.forEach(row => {
                let cols = row.querySelectorAll('th, td');
                let rowData = [];
                cols.forEach(col => {
                    // Detecta Status
                    if (col.querySelector('.fa-circle-check')) rowData.push('Ativo');
                    else if (col.querySelector('.fa-triangle-exclamation')) rowData.push('Atenção');
                    else if (col.querySelector('.fa-circle-xmark')) rowData.push('Inativo');
                    // Detecta Anexo
                    else if (col.querySelector('.fa-paperclip')) rowData.push('Sim');
                    else rowData.push(col.innerText.trim());
                });
                csvContent += rowData.join(';') + '\n';
            });
        
            let blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            let link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = 'relatorio.csv';
            link.click();
        });
        
        </script>
        
</body>
</html>